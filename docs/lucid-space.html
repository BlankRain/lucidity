

<!DOCTYPE html>
<html >
  <head>
    <meta charset="UTF-8">
    <meta name="google" value="notranslate">


    <title>space - management of project externals</title>

    
  <link href='https://fonts.googleapis.com/css?family=Raleway:300' rel='stylesheet' type='text/css'>
  <link rel="stylesheet" type="text/css" href="//cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.5/css/bootstrap.min.css">
  <link rel="stylesheet" type="text/css" href="//cdnjs.cloudflare.com/ajax/libs/font-awesome/4.3.0/css/font-awesome.min.css">

  <script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/8.6/highlight.min.js"></script>
  <script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/8.6/languages/clojure.min.js"></script>
  <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/8.6/styles/magula.min.css">

  <script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/jquery/2.1.4/jquery.min.js"></script>
  <script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.5/js/bootstrap.min.js"></script>
  <script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/angular.js/1.4.2/angular.min.js"></script>
  <script type="text/javascript" src="//ajax.googleapis.com/ajax/libs/angularjs/1.4.2/angular-cookies.min.js"></script>
  <script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/angular-ui-bootstrap/0.13.0/ui-bootstrap-tpls.min.js"></script>
  <script type="text/javascript" src="js/angular-highlightjs.min.js"></script>

  <link rel="stylesheet" type="text/css" href="css/rdash.min.css">
  <link rel="stylesheet" type="text/css" href="css/scrollspy.css">


  <script>
    window.console = window.console || function(t) {};
    window.open = function(){ console.log("window.open is disabled."); };
    window.print   = function(){ console.log("window.print is disabled."); };
  </script>

  <script>
    var app = angular.module('app', ['hljs']);
  </script>
  </head>

  <body ng-app="app" data-spy="scroll" data-target=".scrollspy">
  <!-- Fixed navbar -->
    <nav class="navbar navbar-fixed-top">
      <div class="container" style="margin-left: inherit;">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="index.html"><img src="img/glyph-white.png"></a>
        </div>
        <div id="navbar" class="navbar-collapse collapse">
          <ul class="nav navbar-nav">
            <li class="dropdown">
              <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Guides <span class="caret"></span></a>
              <ul class="dropdown-menu">
                <li><a href="lucid-core.html">core</a></li>
                <!--li><a href="lucid-deploy.html">deploy</a></li-->
                <!--li><a href="lucid-flow.html">flow</a></li-->
                <li><a href="lucid-mind.html">mind</a></li>
                <li><a href="lucid-publish.html">publish</a></li>
                <li><a href="lucid-query.html">query</a></li>
                <li><a href="lucid-space.html">space</a></li>
                <li><a href="lucid-test.html">test</a></li>
            </ul>
            </li>
            <li>
              <a href="https://github.com/tahto/lucidity" target="_blank">Github</a></li>
            <li>
              <a href="http://gitter.im/tahto/lucidity" target="_blank">Gitter</a></li>
          </ul>
        </div><!--/.nav-collapse -->
      </div>
    </nav>


  <div class="container row">
    <div class="col-md-3 scrollspy pull-right">
      <ul id="nav" class="nav hidden-xs hidden-sm" data-spy="affix">
        <li><a href="#introduction">1  &nbsp;&nbsp; Introduction</a><ul class="nav"><li><a href="#installation">1.1  &nbsp;&nbsp; Installation</a></li><li><a href="#motivation">1.2  &nbsp;&nbsp; Motivation</a></li></ul></li><li><a href="#pull">2  &nbsp;&nbsp; Pull</a></li><li><a href="#jar-file">3  &nbsp;&nbsp; Jar File</a><ul class="nav"><li><a href="#maven-file">3.1  &nbsp;&nbsp; maven-file</a></li><li><a href="#coordinate">3.2  &nbsp;&nbsp; coordinate</a></li><li><a href="#jar-entry">3.3  &nbsp;&nbsp; jar-entry</a></li><li><a href="#coordinate-dependencies">3.4  &nbsp;&nbsp; coordinate-dependencies</a></li></ul></li><li><a href="#resolution">4  &nbsp;&nbsp; Resolution</a><ul class="nav"><li><a href="#resolve-jar">4.1  &nbsp;&nbsp; resolve-jar</a></li><li><a href="#contexts">4.2  &nbsp;&nbsp; contexts</a></li><li><a href="#resolve-coordinates">4.3  &nbsp;&nbsp; resolve-coordinates</a></li><li><a href="#resolve-with-deps">4.4  &nbsp;&nbsp; resolve-with-deps</a></li></ul></li>
      </ul>
    </div>
    <div class="col-md-9" id="content">
      <div class="jumbotron">
        <div class="container">
          <h1>space</h1>
          <h4>management of project externals</h4>
        </div>
      </div>
      <section class="chapter" id="introduction"><h2 class="chapter">1  &nbsp;&nbsp; Introduction</h2><div class="group"><div class="paragraph"><p><code>lucid.space</code> allows for introspection of java libraries through maven. The library provides mappings for better understanding where a class, file or namespace is located on the filesystem. This library was originally <a href='https://github.com/zcaudate/hara/korra'>korra</a> and then <a href='https://github.com/zcaudate/maven'>vinyasa.maven</a>.</p></div></div><section class="section" id="installation"><h3 class="section">1.1  &nbsp;&nbsp; Installation</h3><div class="paragraph"><p>Add to <code>project.clj</code> dependencies:</p></div><div class="code"><div hljs="hljs" language="clojure" no-escape="no-escape">[tahto/lucid.space &quot;1.2.0&quot;]</div></div><div class="paragraph"><p>All functionality is in the <code>lucid.space</code> namespace:</p></div><div class="code"><div hljs="hljs" language="clojure" no-escape="no-escape">(use 'lucid.space)</div></div></section><section class="section" id="motivation"><h3 class="section">1.2  &nbsp;&nbsp; Motivation</h3><div class="paragraph"><p>There is a reversible mapping between the maven jar file and the <code>:dependencies</code> for a library specified in <code>project.clj</code>. We can map between a maven coordinate and it's jar file though utility functions. We can also map a 'resource' and its related jar and jar entry under a given context.</p><ul><li>the resource can be:<ul><li>a symbol representing a clojure namespace</li><li>a path to a resource</li><li>a java class</li></ul></li><li>the context can be:<ul><li>the jvm classloader classpath</li><li>a single jar</li><li>a list of jars</li><li>a maven coordinate</li><li>a list of maven coordinates</li><li>the entire maven local-repo.</li></ul></li></ul></div></section></section><section class="chapter" id="pull"><h2 class="chapter">2  &nbsp;&nbsp; Pull</h2><div class="group"><div class="paragraph"><p>This is one of the most useful functions for exploring any clojure library. How many times have you forgotten a library dependency for <code>project.clj</code> and then had to restart your nrepl? <code>pull</code> takes care of the dependencies for the project:</p></div><div class="code"><div hljs="hljs" language="clojure" no-escape="no-escape">(require 'schema.core)
;; java.io.FileNotFoundException: Could not locate hiccup/core__init.class or hiccup/core.clj on classpath:
  
(pull '[prismatic/schema &quot;1.1.3&quot;])
=&gt; '[[prismatic/schema &quot;1.1.3&quot;]]
  
(use 'schema.core)
  
(validate Num 3)
=&gt; 3
  
(validate Num &quot;hello&quot;)
=&gt; (throws)</div></div></div></section><section class="chapter" id="jar-file"><h2 class="chapter">3  &nbsp;&nbsp; Jar File</h2><section class="section" id="maven-file"><h3 class="section">3.1  &nbsp;&nbsp; maven-file</h3><div class="paragraph"><p>We use <code>maven-file</code> to convert a coordinate into a path to a file</p></div><div class="code"><div hljs="hljs" language="clojure" no-escape="no-escape">(maven-file '[org.clojure/clojure &quot;1.6.0&quot;])
=&gt; &quot;../org/clojure/clojure/1.6.0/clojure-1.6.0.jar&quot;</div></div></section><section class="section" id="coordinate"><h3 class="section">3.2  &nbsp;&nbsp; coordinate</h3><div class="paragraph"><p>We use <code>coordinate</code> to convert the path back into a coordinate</p></div><div class="code"><div hljs="hljs" language="clojure" no-escape="no-escape">(coordinate &quot;../org/clojure/clojure/1.6.0/clojure-1.6.0.jar&quot;)
=&gt; '[org.clojure/clojure &quot;1.6.0&quot;]</div></div></section><section class="section" id="jar-entry"><h3 class="section">3.3  &nbsp;&nbsp; jar-entry</h3><div class="paragraph"><p>There is also a mapping between a clojure namespace, a java class and the their location in a jar. This is accessible through <code>jar-entry</code>:</p></div><div class="code"><div hljs="hljs" language="clojure" no-escape="no-escape">(jar-entry (maven-file '[org.clojure/clojure &quot;1.6.0&quot;])
           'clojure.core)
;;  #object[java.util.jar.JarFile$JarFileEntry 0x29a1bd87 &quot;clojure/core.clj&quot;]
  
(jar-entry (maven-file '[org.clojure/clojure &quot;1.6.0&quot;])
           'clojure.core.match)
=&gt; nil</div></div></section><section class="section" id="coordinate-dependencies"><h3 class="section">3.4  &nbsp;&nbsp; coordinate-dependencies</h3><div class="paragraph"><p>To find all coordinate dependencies associated with a given library use the aptly named <code>coordinate-dependencies</code>:</p></div><div class="code"><div hljs="hljs" language="clojure" no-escape="no-escape">(coordinate-dependencies '[[im.chit/hara.event &quot;2.4.4&quot;]])
=&gt; '[[im.chit/hara.data.seq &quot;2.4.4&quot;]
     [im.chit/hara.common.checks &quot;2.4.4&quot;]
     [im.chit/hara.event &quot;2.4.4&quot;]
     [im.chit/hara.common.error &quot;2.4.4&quot;]
     [im.chit/hara.data.map &quot;2.4.4&quot;]
     [im.chit/hara.common.primitives &quot;2.4.4&quot;]]</div></div><div class="code"><div hljs="hljs" language="clojure" no-escape="no-escape">(coordinate-dependencies '[[org.clojure/clojure &quot;1.8.0&quot;]])
=&gt; '[[org.clojure/clojure &quot;1.8.0&quot;]]</div></div></section></section><section class="chapter" id="resolution"><h2 class="chapter">4  &nbsp;&nbsp; Resolution</h2><section class="section" id="resolve-jar"><h3 class="section">4.1  &nbsp;&nbsp; resolve-jar</h3><div class="paragraph"><p>Understanding where a file or namespace comes from is really important because it allows understanding of the structure of the libraries and how they fit together. The main workhorse for file resolution is <code>resolve-jar</code>. It resolves a <code>resource</code> and a <code>context</code>. The default context is the current jvm classpath and can be omitted by default:</p></div><div class="code"><div hljs="hljs" language="clojure" no-escape="no-escape">(resolve-jar 'clojure.core)
=&gt; [&quot;../org/clojure/clojure/1.8.0/clojure-1.8.0.jar&quot;
    &quot;clojure/core.clj&quot;]</div></div><div class="paragraph"><p>It will resolve classes:</p></div><div class="code"><div hljs="hljs" language="clojure" no-escape="no-escape">(resolve-jar java.lang.Object)
=&gt; [&quot;../jdk1.8.0_102.jdk/Contents/Home/jre/lib/rt.jar&quot;
    &quot;java/lang/Object.class&quot;]</div></div><div class="paragraph"><p>It will also resolve paths to files:</p></div><div class="code"><div hljs="hljs" language="clojure" no-escape="no-escape">(resolve-jar &quot;clojure/core.clj&quot;)
=&gt; [&quot;../org/clojure/clojure/1.8.0/clojure-1.8.0.jar&quot;
    &quot;clojure/core.clj&quot;]</div></div><div class="paragraph"><p>Symbols with the last section capitalized will default to java classes instead of clojure files:</p></div><div class="code"><div hljs="hljs" language="clojure" no-escape="no-escape">(resolve-jar 'clojure.lang.IProxy)
=&gt; [&quot;../org/clojure/clojure/1.8.0/clojure-1.8.0.jar&quot;
    &quot;clojure/lang/IProxy.class&quot;]</div></div><div class="paragraph"><p>It will return nil if the resource cannot be found:</p></div><div class="code"><div hljs="hljs" language="clojure" no-escape="no-escape">(resolve-jar 'does.not.exist)
=&gt; nil</div></div></section><section class="section" id="contexts"><h3 class="section">4.2  &nbsp;&nbsp; contexts</h3><div class="paragraph"><p>Apart from searching via the current jvm classpath, other search contexts can be set, the most simple being a string representation of the jar path:</p></div><div class="code"><div hljs="hljs" language="clojure" no-escape="no-escape">(resolve-jar 'clojure.core
             &quot;../org/clojure/clojure/1.6.0/clojure-1.6.0.jar&quot;)
=&gt; [&quot;../org/clojure/clojure/1.6.0/clojure-1.6.0.jar&quot;
    &quot;clojure/core.clj&quot;]</div></div><div class="paragraph"><p>If the entry cannot be found, nil will be returned. In this case, we know that <code>clojure.core</code> is not in the dynapath jar:</p></div><div class="code"><div hljs="hljs" language="clojure" no-escape="no-escape">(resolve-jar 'clojure.core
             &quot;../dynapath/dynapath/0.2.0/dynapath-0.2.0.jar&quot;)
=&gt; nil</div></div><div class="paragraph"><p>In addition to the jar, one can use as the contexte a vector of jar-files:</p></div><div class="code"><div hljs="hljs" language="clojure" no-escape="no-escape">(resolve-jar 'clojure.core
             [&quot;../org/clojure/clojure/1.6.0/clojure-1.6.0.jar&quot;
              &quot;../dynapath/dynapath/0.2.0/dynapath-0.2.0.jar&quot;])
=&gt; [&quot;../org/clojure/clojure/1.6.0/clojure-1.6.0.jar&quot;
    &quot;clojure/core.clj&quot;]</div></div><div class="paragraph"><p>or a coordinate:</p></div><div class="code"><div hljs="hljs" language="clojure" no-escape="no-escape">(resolve-jar 'clojure.core '[org.clojure/clojure &quot;1.6.0&quot;])
=&gt; [&quot;../org/clojure/clojure/1.6.0/clojure-1.6.0.jar&quot;
    &quot;clojure/core.clj&quot;]</div></div><div class="paragraph"><p>or a vector of coordinates:</p></div><div class="code"><div hljs="hljs" language="clojure" no-escape="no-escape">(resolve-jar 'clojure.core '[[org.clojure/clojure &quot;1.6.0&quot;]
                             [dynapath &quot;0.2.0&quot;]])
=&gt; [&quot;../org/clojure/clojure/1.6.0/clojure-1.6.0.jar&quot;
    &quot;clojure/core.clj&quot;]</div></div><div class="paragraph"><p>or if you simply just want to explore, the context can be an entire maven local repository:</p></div><div class="code"><div hljs="hljs" language="clojure" no-escape="no-escape">(resolve-jar 'clojure.core :repository)
=&gt; [&quot;../org/clojure/clojure/1.8.0/clojure-1.8.0.jar&quot;
    &quot;clojure/core.clj&quot;]
  
(resolve-jar 'dynapath.util :repository)
=&gt; [&quot;../org/tcrawley/dynapath/0.2.4/dynapath-0.2.4.jar&quot;
    &quot;dynapath/util.clj&quot;]</div></div></section><section class="section" id="resolve-coordinates"><h3 class="section">4.3  &nbsp;&nbsp; resolve-coordinates</h3><div class="paragraph"><p><code>resolve-coordinates</code> works similarly to <code>resolve-jar</code> but will return the actual maven-style coordinates</p></div><div class="code"><div hljs="hljs" language="clojure" no-escape="no-escape">(resolve-coordinates 'version-clj.core)
=&gt; '[version-clj/version-clj &quot;0.1.2&quot;]
  
(resolve-coordinates 'clojure.core :repository)
=&gt; '[org.clojure/clojure &quot;1.8.0&quot;]</div></div></section><section class="section" id="resolve-with-deps"><h3 class="section">4.4  &nbsp;&nbsp; resolve-with-deps</h3><div class="paragraph"><p><code>resolve-with-deps</code> will recursively search all child dependencies until it finds the file:</p></div><div class="code"><div hljs="hljs" language="clojure" no-escape="no-escape">(resolve-with-deps 'hara.test
                   '[[im.chit/hara &quot;2.4.4&quot;]])
=&gt; [&quot;../im/chit/hara.test/2.4.4/hara.test-2.4.4.jar&quot;
    &quot;hara/test.clj&quot;]</div></div></section></section>
    </div>
</div><!--end of .container-->

  <section class="application">
    
  </section>
</body>

<script>
  $('#nav').affix({
    offset: {
        top: $('#nav').offset().top,
        bottom: $('footer').outerHeight(true) + $('.application').outerHeight(true) + 40
    }});
</script>


<script>
  if (document.location.search.match(/type=embed/gi)) {
    window.parent.postMessage("resize", "*");
  }
</script>
</body>
</html>
