

<!DOCTYPE html>
<html >
  <head>
    <meta charset="UTF-8">
    <meta name="google" value="notranslate">


    <title>publish - generate documentation from code</title>

    
  <link href='https://fonts.googleapis.com/css?family=Raleway:300' rel='stylesheet' type='text/css'>
  <link rel="stylesheet" type="text/css" href="//cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.5/css/bootstrap.min.css">
  <link rel="stylesheet" type="text/css" href="//cdnjs.cloudflare.com/ajax/libs/font-awesome/4.3.0/css/font-awesome.min.css">

  <script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/8.6/highlight.min.js"></script>
  <script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/8.6/languages/clojure.min.js"></script>
  <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/8.6/styles/magula.min.css">

  <script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/jquery/2.1.4/jquery.min.js"></script>
  <script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.5/js/bootstrap.min.js"></script>
  <script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/angular.js/1.4.2/angular.min.js"></script>
  <script type="text/javascript" src="//ajax.googleapis.com/ajax/libs/angularjs/1.4.2/angular-cookies.min.js"></script>
  <script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/angular-ui-bootstrap/0.13.0/ui-bootstrap-tpls.min.js"></script>
  <script type="text/javascript" src="js/angular-highlightjs.min.js"></script>

  <link rel="stylesheet" type="text/css" href="css/rdash.min.css">
  <link rel="stylesheet" type="text/css" href="css/scrollspy.css">


  <script>
    window.console = window.console || function(t) {};
    window.open = function(){ console.log("window.open is disabled."); };
    window.print   = function(){ console.log("window.print is disabled."); };
  </script>

  <script>
    var app = angular.module('app', ['hljs']);
  </script>
  </head>

  <body ng-app="app" data-spy="scroll" data-target=".scrollspy">
  <!-- Fixed navbar -->
    <nav class="navbar navbar-fixed-top">
      <div class="container" style="margin-left: inherit;">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="index.html"><img src="img/glyph-white.png"></a>
        </div>
        <div id="navbar" class="navbar-collapse collapse">
          <ul class="nav navbar-nav">
            <li class="dropdown">
              <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Guides <span class="caret"></span></a>
              <ul class="dropdown-menu">
                <li><a href="lucid-core.html">core</a></li>
                <!--li><a href="lucid-deploy.html">deploy</a></li-->
                <!--li><a href="lucid-flow.html">flow</a></li-->
                <li><a href="lucid-mind.html">mind</a></li>
                <li><a href="lucid-publish.html">publish</a></li>
                <li><a href="lucid-query.html">query</a></li>
                <li><a href="lucid-space.html">space</a></li>
                <li><a href="lucid-test.html">test</a></li>
            </ul>
            </li>
            <li>
              <a href="https://github.com/tahto/lucidity" target="_blank">Github</a></li>
            <li>
              <a href="http://gitter.im/tahto/lucidity" target="_blank">Gitter</a></li>
          </ul>
        </div><!--/.nav-collapse -->
      </div>
    </nav>


  <div class="container row">
    <div class="col-md-3 scrollspy pull-right">
      <ul id="nav" class="nav hidden-xs hidden-sm" data-spy="affix">
        <li><a href="#introduction">1  &nbsp;&nbsp; Introduction</a></li><li><a href="#installation">2  &nbsp;&nbsp; Installation</a><ul class="nav"><li><a href="#motivation">2.1  &nbsp;&nbsp; Motivation</a></li></ul></li><li><a href="#design-driven-development">3  &nbsp;&nbsp; Design Driven Development</a></li><li><a href="#api-reference">4  &nbsp;&nbsp; API Reference</a><ul class="nav"><li><a href="#the-basics">4.1  &nbsp;&nbsp; The Basics</a></li><li><a href="#sectioning-elements">4.2  &nbsp;&nbsp; Sectioning Elements</a></li><li><a href="#content-elements">4.3  &nbsp;&nbsp; Content Elements</a></li><li><a href="#code-elements">4.4  &nbsp;&nbsp; Code Elements</a></li></ul></li><li><a href="#a-bugs-life">5  &nbsp;&nbsp; A Bug's Life</a><ul class="nav"><li><a href="#version-one">5.1  &nbsp;&nbsp; Version One</a></li><li><a href="#version-two">5.2  &nbsp;&nbsp; Version Two</a></li><li><a href="#the-bug-surfaces">5.3  &nbsp;&nbsp; The Bug Surfaces</a></li></ul></li>
      </ul>
    </div>
    <div class="col-md-9" id="content">
      <div class="jumbotron">
        <div class="container">
          <h1>publish</h1>
          <h4>generate documentation from code</h4>
        </div>
      </div>
      <section class="chapter" id="introduction"><h2 class="chapter">1  &nbsp;&nbsp; Introduction</h2><div class="group"><div class="paragraph"><p><code>lucid.publish</code> facilitates the creation of 'documentation that we can run', the tool allows for a design-orientated workflow for the programming process, blurring the boundaries between design, development, testing and documentation. This library was originally developed as <a href='https://www.github.com/zcaudate/lein-midje-doc'>lein-midje-doc</a>, and then <a href='https://www.github.com/helpshift/hydrox'>hydrox</a>.</p></div></div></section><section class="chapter" id="installation"><h2 class="chapter">2  &nbsp;&nbsp; Installation</h2><div class="group"><div class="paragraph"><p>Add to <code>project.clj</code> dependencies:</p></div><div class="code"><div hljs="hljs" language="clojure" no-escape="no-escape">[tahto/lucid.publish &quot;1.2.0&quot;]</div></div><div class="paragraph"><p>All functionality is in the <code>lucid.publish</code> namespace:</p></div><div class="code"><div hljs="hljs" language="clojure" no-escape="no-escape">(use 'lucid.publish)</div></div></div><section class="section" id="motivation"><h3 class="section">2.1  &nbsp;&nbsp; Motivation</h3><div class="paragraph"><p>Documentation is the programmers' means of communicating how to use a library. There are various tools for documentation like <code>latex</code>, <code>wiki</code> and <code>markdown</code>- however, they are not linked to code and</p><ol><li>To generate <code>.html</code> documentation from a <code>.clj</code> test file.</li><li>Check code-examples for errors using test suites</li><li>Render code and test cases as examples</li><li>Latex-like numbering and linking facilities</li><li>Code as Communication</li></ol></div></section></section><section class="chapter" id="design-driven-development"><h2 class="chapter">3  &nbsp;&nbsp; Design Driven Development</h2><div class="group"><div class="paragraph"><p>Documentation at the design level requires more visual elements than documentation at the function level. <code>lucid.publish</code> can generates a <code>.html</code> output based on a <code>.clj</code> file. This requires some configuration and so the following is placed in the <code>project.clj</code> file:</p></div><div class="code"><div hljs="hljs" language="clojure" no-escape="no-escape">(defproject ...
  ...
  :publish {:site   &quot;sample&quot;
            :output &quot;docs&quot;
            :paths [&quot;test/documentation&quot;]
            :files {&quot;sample-document&quot;
                    {:input &quot;test/documentation/sample_document.clj&quot;
                     :title &quot;a sample document&quot;
                     :subtitle &quot;generating a document from code&quot;}}}
  ...)</div></div><div class="paragraph"><p>The <code>:publish</code> key in <code>defproject</code> specifies which files to use as entry points to use for html generation. A sample can be seen below:</p></div><div class="code"><div hljs="hljs" language="clojure" no-escape="no-escape">(ns documentation.sample.document
  (:require [midje.sweet :refer :all]))

[[:chapter {:tag &quot;hello&quot; :title &quot;Hello Midje Doc&quot;}]]

&quot;This is an introduction to writing with midje-doc.&quot;

[[:section {:title &quot;Defining a function&quot;}]]

&quot;We define function `add-5` below:&quot;

[[{:numbered false}]]
(defn add-5 [x]
  (+ x 5))

[[:section {:title &quot;Testing a function&quot;}]]

&quot;`add-5` outputs the following results:&quot;

(facts
  [[{:tag &quot;add-5-1&quot; :title &quot;1 add 5 = 6&quot;}]]
  (add-5 1) =&gt; 6

  [[{:tag &quot;add-5-10&quot; :title &quot;10 add 5 = 15&quot;}]]
  (add-5 10) =&gt; 15)</div></div><div class="paragraph"><p>A pretty looking html document can be generated by running <code>publish</code>:</p></div><div class="code"><div hljs="hljs" language="clojure" no-escape="no-escape">(publish &quot;sample-document&quot;)</div></div><div class="paragraph"><p>The <code>:output</code> entry specifies the directory that files are rendered to.</p></div></div></section><section class="chapter" id="api-reference"><h2 class="chapter">4  &nbsp;&nbsp; API Reference</h2><section class="section" id="the-basics"><h3 class="section">4.1  &nbsp;&nbsp; The Basics</h3><section class="subsection" id="elements"><h4 class="subsection">4.1.1  &nbsp;&nbsp; elements</h4><div class="paragraph"><p>Elements are constructed using a tag and a map contained within double square brackets. Elements tags have been inspired from latex:</p><ul><li><a href='#sectioning-elements'>Sectioning Elements</a></li><li><a href='#text-elements'>Text Elements</a></li><li><a href='#code-elements'>Code Elements</a></li><li><a href='#additional-elements'>Additional Elements</a></li></ul><p>Clojure strings are treated as paragraph elements whilst clojure forms are treated as code elements. <code>fact</code> and <code>comment</code> forms are also considered code elements. Elements will be described in detail in their respective sections.</p></div><div class="code"><a name="elements-ex1"></a><h5>e.4.1  &nbsp;-&nbsp; Element Notation</h5><div hljs="hljs" language="clojure" no-escape="no-escape">[[&lt;tag&gt; {&lt;key1&gt; &lt;value1&gt;, &lt;key2&gt; &lt;value2&gt;}]]

for example

[[:chapter {:title &quot;Hello World&quot; :tag &quot;hello&quot;}]]</div></div></section><section class="subsection" id="attributes"><h4 class="subsection">4.1.2  &nbsp;&nbsp; attributes</h4><div class="paragraph"><p>Attribute add additional metadata to elements. They are written as a single hashmap within double square brackets. Attributes mean nothing by themselves. They change the properties of elements directly after them.</p></div><div class="code"><div hljs="hljs" language="clojure" no-escape="no-escape">[[{:tag &quot;my-paragraph&quot;}]]
[[:paragraph {:content &quot;This is a paragraph&quot;}]]

is equivalent to

[[:paragraph {:content &quot;This is a paragraph&quot;
              :tag &quot;my-paragraph&quot;}]]</div></div><div class="paragraph"><p>Multiple attributes can be stacked to modify an element:</p></div><div class="code"><div hljs="hljs" language="clojure" no-escape="no-escape">[[{:numbered false}]]
[[{:lang &quot;shell&quot;}]]
(comment
  &gt; lein repl)</div></div><div class="paragraph"><p>produces the following shell code:</p></div><div class="code"><div hljs="hljs" language="shell" no-escape="no-escape">&gt; lein repl</div></div></section></section><section class="section" id="sectioning-elements"><h3 class="section">4.2  &nbsp;&nbsp; Sectioning Elements</h3><div class="paragraph"><p>Sectioning elements are taken from latex and allow the document to be organised into logical sections. From highest to lowest order of priority, they are: <code>:chapter</code>, <code>section</code>, <code>subsection</code> and <code>:subsubsection</code>, giving four levels of organisation.</p><p>The numbering for elements are generated in sequencial order: <code>&#40;1, 2, 3 ... etc&#41;</code> and a tag can be generated from the title or specified for creating links within the document. <code>:chapter</code>, <code>section</code> and <code>subsection</code> elements are list in the table of contents using tags.</p><p>For example, I wish to write a chapter about animals and have organised content into categories shown below.</p></div><div class="code"><div hljs="hljs" language="clojure" no-escape="no-escape">Animals
- Mammals
- Birds
*- Can Fly
**- Eagle
**- Hummingbird
*- Flightless
**- Penguin</div></div><div class="paragraph"><p>It is very straight forward to turn this into sectioning elements which will then generate the sectioning numbers for different categories</p></div><div class="code"><div hljs="hljs" language="clojure" no-escape="no-escape">[[:chapter {:title &quot;Animals&quot;}]]
[[:section {:title &quot;Mammals&quot;}]]
[[:section {:title &quot;Birds&quot;}]]
[[:subsection {:title &quot;Can Fly&quot;}]]
[[:subsubsection {:title &quot;Eagle&quot;}]]
[[:subsubsection {:title &quot;Hummingbird&quot;}]]
[[:subsection {:title &quot;Flightless&quot;}]]
[[:subsubsection {:title &quot;Penguin&quot;}]]</div></div><div class="paragraph"><p>The sections will be automatically numbered as show below:</p></div><div class="code"><div hljs="hljs" language="clojure" no-escape="no-escape">*1 Animals                ;; animals
*1.1 Mammals              ;; mammals
*1.2 Birds                ;; birds
  *1.2.1 Can Fly          ;; can-fly
    *1.2.1.1 Eagle        ;; eagle
    *1.2.1.2 Hummingbird  ;; hummingbird
  *1.2.2 Flightless       ;; flightless
    *1.2.2.1 Penguin      ;; penguin</div></div></section><section class="section" id="content-elements"><h3 class="section">4.3  &nbsp;&nbsp; Content Elements</h3><div class="paragraph"><p>Content elements include <code>:paragraph</code>, <code>:image</code>, and <code>file</code> elements.</p></div><section class="subsection" id="paragraph"><h4 class="subsection">4.3.1  &nbsp;&nbsp; :paragraph</h4><div class="paragraph"><p>Paragraph elements should make up the bulk of the documentation. They can be written as an element or in the usual case, as a string. The string is markdown with templating - so that chapter, section, code and image numbers can be referred to by their tags.</p></div><div class="code"><h5>e.4.2  &nbsp;-&nbsp; Paragraph Element</h5><div hljs="hljs" language="clojure" no-escape="no-escape">[[:paragraph {:content &quot;Here is some content&quot;}]]</div></div><div class="code"><h5>e.4.3  &nbsp;-&nbsp; Paragraph String</h5><div hljs="hljs" language="clojure" no-escape="no-escape">&quot;Here is some content&quot;</div></div><div class="code"><h5>e.4.4  &nbsp;-&nbsp; Markdown String</h5><div hljs="hljs" language="clojure" no-escape="no-escape">[[:chapter {:title &quot;Chapter Heading&quot; :tag &quot;ch-heading&quot;}]]

&quot;
# Heading One
Here is some text.
Here is a tag reference to Chapter Heading - {{ch-heading}}

- Here is a bullet point
- Here is another one&quot;</div></div></section><section class="subsection" id="image"><h4 class="subsection">4.3.2  &nbsp;&nbsp; :image</h4><div class="paragraph"><p>The <code>:image</code> element embeds an image as a figure within the document. It is numbered and can be tagged for easy reference. The code example produces the image seen in Figure 1:</p></div><div class="code"><div hljs="hljs" language="clojure" no-escape="no-escape">[[:image {:tag &quot;clojure-logo&quot; :title &quot;Clojure Logo (source clojure.org)&quot;
          :src &quot;http://clojure.org/space/showimage/clojure-icon.gif&quot;}]]</div></div><div class="figure"><a name="clojure-logo"></a><div class="img"><img src="http://clojure.org/space/showimage/clojure-icon.gif" /></div><h4><i>fig.1  &nbsp;-&nbsp; Clojure Logo (source clojure.org)</i></h4></div></section><section class="subsection" id="file"><h4 class="subsection">4.3.3  &nbsp;&nbsp; :file</h4><div class="paragraph"><p>The <code>:file</code> element allows inclusion of other files into the document. It is useful for breaking up a document into managable chunks. A file element require that the <code>:src</code> attribute be specified. A high-level view of a document can thus be achieved, making the source more readable. This is similar to the <code>include</code> element in latex.</p></div><div class="code"><a name="file-element"></a><h5>e.4.5  &nbsp;-&nbsp; :file tag example</h5><div hljs="hljs" language="clojure" no-escape="no-escape">[[:file {:src &quot;test/docs/first_section.clj&quot;}]]
[[:file {:src &quot;test/docs/second_section.clj&quot;}]]
[[:file {:src &quot;test/docs/third_section.clj&quot;}]]</div></div></section></section><section class="section" id="code-elements"><h3 class="section">4.4  &nbsp;&nbsp; Code Elements</h3><div class="paragraph"><p>Code displayed in documentation are of a few types:</p><ol><li>Code that needs to be run (normal clojure code)</li><li>Code that needs verification taking input and showing output. (midje fact)</li><li>Code that should not be run (namespace declaration examples)</li><li>Code that is part of the library's tests or source definition</li><li>Code in other languages</li></ol><p>The different types of code can be defined so that code examples render properly using a variety of methods</p></div><section class="subsection" id="normal-s-expressions"><h4 class="subsection">4.4.1  &nbsp;&nbsp; normal s-expressions</h4><div class="paragraph"><p>Normal s-expressions are rendered as is. Attributes can be added for grouping purposes. The source code shown below</p></div><div class="code"><a name="c-add-src"></a><h5>e.4.6  &nbsp;-&nbsp; seperating code blocks through attributes</h5><div hljs="hljs" language="clojure" no-escape="no-escape">[[{:title &quot;add-n definition&quot; :tag &quot;c-add-1&quot;}]]
(defn add-n [n]
  (fn [x] (+ x n)))

[[{:title &quot;add-4 and add-5 definitions&quot; :tag &quot;c-add-2&quot;}]]
(def add-4 (add-n 4))
(def add-5 (add-n 5))</div></div><div class="paragraph"><p>renders the following outputs:</p></div><div class="code"><a name="c-add-1"></a><h5>e.4.7  &nbsp;-&nbsp; add-n definition</h5><div hljs="hljs" language="clojure" no-escape="no-escape">(defn add-n [n]
  (fn [x] (+ x n)))</div></div><div class="code"><a name="c-add-2"></a><h5>e.4.8  &nbsp;-&nbsp; add-4 and add-5 definitions</h5><div hljs="hljs" language="clojure" no-escape="no-escape">(def add-4 (add-n 4))
(def add-5 (add-n 5))</div></div></section><section class="subsection" id="test-forms"><h4 class="subsection">4.4.2  &nbsp;&nbsp; test forms</h4><div class="paragraph"><p>Documentation examples put in <code>facts</code> forms allows the code to be verified for correctness using <code>lein midje</code>. Document element notation still be rendered except before and after the midje arrows (<strong>=></strong>). Consecutive code within a fact form will stacked as one common code block.</p></div><div class="paragraph"><p>The source form:</p></div><div class="code"><a name="c-facts-src"></a><h5>e.4.9  &nbsp;-&nbsp; Facts Form Source</h5><div hljs="hljs" language="clojure" no-escape="no-escape">[[{:tag &quot;facts-form-output&quot; :title &quot;Facts Form Output&quot;}]]
(facts
  [[{:title &quot;Definining an atom&quot; :tag &quot;c-facts-1&quot;}]]
  (def a (atom 1))
  (deref a) =&gt; 1

  [[{:title &quot;Updating the atom&quot; :tag &quot;c-facts-2&quot;}]]
  (swap! a inc)
  (deref a) =&gt; 2)</div></div><div class="paragraph"><p>Renders the following output:</p></div><div class="code"><div hljs="hljs" language="clojure" no-escape="no-escape">s
[[{:title &quot;Definining an atom&quot; :tag &quot;c-facts-1&quot;}]]
(def a (atom 1))
(deref a) =&gt; 1

[[{:title &quot;Updating the atom&quot; :tag &quot;c-factss-2&quot;}]]
(swap! a inc)
(deref a) =&gt; 2</div></div></section><section class="subsection" id="fact-form"><h4 class="subsection">4.4.3  &nbsp;&nbsp; fact form</h4><div class="paragraph"><p>For an entire block to be embedded in code, use the <code>fact</code> form. The source form:</p></div><div class="code"><a name="c-fact-src"></a><h5>e.4.10  &nbsp;-&nbsp; Fact Form Source</h5><div hljs="hljs" language="clojure" no-escape="no-escape">[[{:tag &quot;fact-form-output&quot; :title &quot;Fact Form Output&quot;}]]
(fact
  (def a (atom 1))
  (deref a) =&gt; 1

  (swap! a inc 1)
  (deref a) =&gt; 2)</div></div><div class="paragraph"><p>Renders the following output:</p></div><div class="code"><div hljs="hljs" language="clojure" no-escape="no-escape">(def a (atom 1))
(deref a) =&gt; 1

(swap! a inc)
(deref a) =&gt; 2</div></div></section><section class="subsection" id="comments"><h4 class="subsection">4.4.4  &nbsp;&nbsp; comments</h4><div class="paragraph"><p>Comments are clojure's built-in method of displaying non-running code and so this mechanisim is used in clojure for displaying code that should not be run, but still requires display. Code can still output without interferring with code or tests.</p></div><div class="code"><a name="c-com-src"></a><h5>e.4.11  &nbsp;-&nbsp; Switching to a new namespace</h5><div hljs="hljs" language="clojure" no-escape="no-escape">[[{:title &quot;Switching to a new namespace&quot; :tag &quot;c-com-1&quot;}]]
(comment
  (in-ns 'hello.world)
  (use 'clojure.string)
  (split &quot;Hello World&quot; #&quot;&#92;s&quot;) ;=&gt; [&quot;Hello&quot; &quot;World&quot;]
  )</div></div><div class="code"><a name="c-com-1"></a><h5>e.4.12  &nbsp;-&nbsp; Switching to a new namespace</h5><div hljs="hljs" language="clojure" no-escape="no-escape">(in-ns 'hello.world)
(use 'clojure.string)
(split &quot;Hello World&quot; #&quot;&#92;s&quot;) ;=&gt; [&quot;Hello&quot; &quot;World&quot;]</div></div></section><section class="subsection" id="code"><h4 class="subsection">4.4.5  &nbsp;&nbsp; code</h4><div class="paragraph"><p>The most generic way of displaying code is with the <code>:code</code> tag. It is useful when code in other languages are required to be in the documentation.</p></div><section class="subsubsection" id="python-example"><h4 class="subsubsection">4.4.5.1  &nbsp;&nbsp; Python Example</h4><div class="paragraph"><p>The source and outputs are listed below:</p></div><div class="code"><a name="c-py-src"></a><h5>e.4.13  &nbsp;-&nbsp; Python for Loop Source</h5><div hljs="hljs" language="clojure" no-escape="no-escape">[[:code {:lang &quot;python&quot; :title &quot;Python for Loop&quot; :tag &quot;c-py-1&quot;}
&quot;
myList = [1,2,3,4]
for index in range(len(myList)):
  myList[index] += 1
print myList&quot;]]</div></div><div class="code"><a name="c-py-1"></a><h5>e.4.14  &nbsp;-&nbsp; Python for Loop</h5><div hljs="hljs" language="python" no-escape="no-escape">
myList = [1,2,3,4]
for index in range(len(myList)):
  myList[index] += 1
print myList</div></div></section><section class="subsubsection" id="ruby-example"><h4 class="subsubsection">4.4.5.2  &nbsp;&nbsp; Ruby Example</h4><div class="paragraph"><p>The source and outputs are listed below:</p></div><div class="code"><a name="c-rb-src"></a><h5>e.4.15  &nbsp;-&nbsp; Ruby for Loop Source</h5><div hljs="hljs" language="clojure" no-escape="no-escape">[[:code {:lang &quot;ruby&quot; :title &quot;Ruby for Loop&quot; :tag &quot;c-rb-2&quot;}
&quot;
array.each_with_index do |element,index|
  element.do_stuff(index)
end&quot;]]</div></div><div class="code"><a name="c-rb-2"></a><h5>e.4.16  &nbsp;-&nbsp; Ruby for Loop</h5><div hljs="hljs" language="ruby" no-escape="no-escape">
array.each_with_index do |element,index|
  element.do_stuff(index)
end</div></div></section></section></section></section><section class="chapter" id="a-bugs-life"><h2 class="chapter">5  &nbsp;&nbsp; A Bug's Life</h2><section class="section" id="version-one"><h3 class="section">5.1  &nbsp;&nbsp; Version One</h3><div class="paragraph"><p>A new clojure project is created.</p></div><div class="code"><div hljs="hljs" language="bash" no-escape="no-escape">&gt; lein new fami
&gt; cd fami
&gt; lein repl</div></div><div class="paragraph"><p>A very useful function <code>add-5</code> has been defined:</p></div><div class="code"><a name="add-5-fn"></a><h5>e.5.1  &nbsp;-&nbsp; src/fami/operations.clj</h5><div hljs="hljs" language="clojure" no-escape="no-escape">(ns fami.operations)

(defn add-5
  &quot;add-5 is a function that takes any number of arguments
   and adds 5 to the sum&quot;
  [&amp; ns]
  (apply + 5 ns))</div></div><div class="paragraph"><p>And the corresponding tests specified:</p></div><div class="code"><a name="add-5-tests"></a><h5>e.5.2  &nbsp;-&nbsp; src/fami/test-operations.clj</h5><div hljs="hljs" language="clojure" no-escape="no-escape">(ns fami.test-operations
  (:require [fami.operations :refer :all]
            [midje.sweet :refer :all]))

(fact &quot;add-5 should increment any list of numbers by 5&quot;
  (add-5 5)  =&gt; 10
  (add-5 1 2 3 4) =&gt; 15)</div></div><div class="paragraph"><p>There are additional entries for the operation in the readme as well as also being scattered around in various other documents.</p></div><div class="code"><a name="add-5-readme"></a><h5>e.5.3  &nbsp;-&nbsp; readme.md, operations.md</h5><div hljs="hljs" language="clojure" no-escape="no-escape">...

Here are some of the use cases for add-5

(add-5 5)    ;; =&gt; 10
(add-5 1 2 3 4)   ;; =&gt; 15
  
...</div></div><div class="paragraph"><p>This version of this library has been released as <strong>version 1.0</strong></p></div></section><section class="section" id="version-two"><h3 class="section">5.2  &nbsp;&nbsp; Version Two</h3><div class="paragraph"><p>The library is super successful with many users. The code undergoes refactoring and it is decided that the original <code>add-5</code> is too powerful and so it must be muted to only accept one argument. An additional function <code>add-5-multi</code> is used to make explicit that the function is taking multiple arguments.</p></div><div class="code"><a name="add-5-v2"></a><h5>e.5.4  &nbsp;-&nbsp; src/fami/operations.clj - v2</h5><div hljs="hljs" language="clojure" no-escape="no-escape">(ns fami.operations)

(defn add-5 [n]   ;; The muted version
  &quot;add-5 is a function that takes a number and adds 5 to it&quot;
  (+ n 5))

(defn add-5-multi
  &quot;add-5-multi is a function that takes any number of arguments
   and adds 5 to the sum&quot;
  [&amp; ns]
  (apply + 5 ns))</div></div><div class="paragraph"><p>The tests throw an exception but are quickly fixed:</p></div><div class="code"><a name="add-5-v2-tests"></a><h5>e.5.5  &nbsp;-&nbsp; src/fami/test-operations.clj</h5><div hljs="hljs" language="clojure" no-escape="no-escape">(ns fami.test-operations
 (:require [fami.operations :refer :all]
           [midje.sweet :refer :all]))

 (fact &quot;add-5 should increment only one input by 5&quot;
 (add-5 5) =&gt; 10
 (add-5 1 2) =&gt; (throws clojure.lang.ArityException))

 (fact &quot;add-5-multi should increment any list of numbers by 5&quot;
 (add-5-multi 1 2 3 4) =&gt; 15)</div></div><div class="paragraph"><p>This version of this library has been released as <strong>version 2.0</strong></p></div></section><section class="section" id="the-bug-surfaces"><h3 class="section">5.3  &nbsp;&nbsp; The Bug Surfaces</h3><div class="paragraph"><p>Although the tests are correct, the documentation is not. Anyone using this library can potentially have the <code>clojure.lang.ArityException</code> bug if they carefully followed instructions in the documentation.</p><p>This is a trival example of a much greater problem. When a project begins to evolve and codebase begins to change, the documentation then becomes incorrect. Although source and test code can be isolated through testing, fixing documentation is a miserable and futile exercise of cut and paste. With no real tool to check whether code is still valid, the documentation become less and less correct until all the examples have to be rechecked and the documention rewritten.</p><p><strong>Then the codebase changes again ...</strong></p><p>Once the library has been release to the world and people have already started using it, there is no taking it back. Bugs propagate through miscommunication. Miscommunication with machines can usually be contained and fixed. Miscommunication with people becomes potentially more difficult to contain.</p><p>This simple scenario highlights the problem that developers have when updating documentation. When we cannot <code>prove</code> that our documentation is correct, then the cost of fixing out of date documentation becomes bigger and bigger as time progresses. With <code>hydrox</code> this process just became much more cost effective.</p></div></section></section>
    </div>
</div><!--end of .container-->

  <section class="application">
    
  </section>
</body>

<script>
  $('#nav').affix({
    offset: {
        top: $('#nav').offset().top,
        bottom: $('footer').outerHeight(true) + $('.application').outerHeight(true) + 40
    }});
</script>


<script>
  if (document.location.search.match(/type=embed/gi)) {
    window.parent.postMessage("resize", "*");
  }
</script>
</body>
</html>
